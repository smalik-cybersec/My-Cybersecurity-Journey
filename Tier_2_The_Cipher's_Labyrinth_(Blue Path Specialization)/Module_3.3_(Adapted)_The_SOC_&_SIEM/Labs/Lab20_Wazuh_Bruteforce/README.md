# Lab 20: Detecting a Brute-Force Attack with Active Correlation

### **Objective**

This lab demonstrates the use of a Wazuh SIEM to detect an active SSH brute-force attack. The key outcome is observing Wazuh's correlation engine automatically escalating multiple individual failed logins into a single, high-severity composite alert.

### **Lab Architecture**

This exercise utilized a three-VM environment to simulate a realistic attack scenario:

- **Analyst VM:** A virtual machine running the Wazuh SIEM, serving as the Security Operations Center (SOC).
- **Target VM:** A virtual machine running Ubuntu Server with a Wazuh agent, representing a monitored asset.
- **Attacker VM:** A Kali Linux instance used to launch the simulated attack.

### **Execution Steps (The Attack)**

From the Kali Linux VM, the `hydra` password cracking tool was used to launch a high-volume SSH brute-force attack against the Target VM.

1. **Target IP Address:** [Enter the IP of your Target VM here]
2. **Attacker Command:**

    ```bash
    hydra -l shahid -P /usr/share/wordlists/fasttrack.txt ssh://[Enter Target VM IP Here]
    ```

### **Evidence of Analysis (The Detection)**

The following screenshot, taken from the Analyst VM's Wazuh dashboard, shows the single composite alert generated by the attack. This single alert is far more valuable than the hundreds of individual failed logins it was derived from.

### **Analysis and Conclusion**

- **Event Correlation:** The Wazuh SIEM successfully correlated hundreds of low-level "Authentication failure" (Level 5) events into a single, "Multiple authentication failures" (Level 10) alert. This demonstrates the power of a SIEM to identify a developing attack pattern from noisy, low-level log data.

- **Actionable Intelligence:** The most critical piece of data in the composite alert is the `data.srcip` field, which correctly identified the attacker's IP address. This is the definition of actionable intelligence, as it provides a SOC analyst with the necessary information to take immediate defensive action, such as implementing a firewall rule to block the malicious IP.

- **Attack Narrative:** The alert provides a complete and concise story: an attacker from a specific IP launched a brute-force attack targeting the SSH service on a monitored server. This ability to instantly understand the what, where, and who of an attack is fundamental to an effective security operation.
